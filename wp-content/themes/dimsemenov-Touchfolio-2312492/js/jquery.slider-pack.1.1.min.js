/*
 * Two Dimensional Slider for Touchfolio theme.  
 * 
 * Copyright 2012 Dmitry Semenov. http://dimsemenov.com
 * 
 * You must not use this slider outside the Touchfolio theme. Slider is based on commercial RoyalSlider script.
 *
*/

;(function(h){function v(b,c){var d=navigator.userAgent.toLowerCase(),a=this,f=jQuery.browser,g=f.mozilla,f=f.webkit;d.match(/(iphone|ipod|ipad)/);d.indexOf("android");var m=-1<d.indexOf("chrome"),e=-1!=navigator.appVersion.indexOf("Mac"),d=document.createElement("div").style,n=["webkit","Moz","ms","O"],l="",r;for(i=0;i<n.length;i++)r=n[i],!l&&r+"Transform"in d&&(l=r),r=r.toLowerCase();a._isChrome=m;a._wpVars=tdSliderVars;a.sliderRoot=h(b);a._slidesWrapper=a.sliderRoot.find(".slider-wrapper");a._loopItems=
!1;a._loopAlbums=!1;a.onTransitionStart=function(){};a.onTransitionComplete=function(){};a._startTime;a._moveDist;a._accelerationX;a._accelerationY;a._currAnimSpeed;a._isVerticalNav=!1;a._currMoveAxis="none";a._collapsedSlider=!1;a._isAnimating=!1;a._isDragging=!1;a._multipleTouches=!1;a.moved;a.startX;a.startY;a.pointX;a.pointY;a.changedX;a.changedY;a.firstLoaded=!1;a.directionLocked;a.x=0;a.y=0;a.loadingTimeout;a.settings=h.extend({},h.fn.twoDimSlider.defaults,c);a._useCSS3Transitions=a._use3dTransform=
m?!1:Modernizr.csstransforms3d;a._orientationChangeEvent="onorientationchange"in window?"orientationchange.tds resize.tds":"resize.tds";if(window.navigator.msPointerEnabled){if("ontouchstart"in window||"createTouch"in document)a.hasTouch=!1;a._downEvent="MSPointerDown.tds";a._moveEvent="MSPointerMove.tds";a._upEvent="MSPointerUp.tds ";a._cancelEvent=a._upEvent;a._clickEvent=a._downEvent}else"ontouchstart"in window||"createTouch"in document?(a.hasTouch=!0,a._downEvent="touchstart.tds",a._moveEvent=
"touchmove.tds",a._upEvent="touchend.tds ",a._cancelEvent="touchcancel.tds",a._clickEvent="touchstart"):(a.hasTouch=!1,a._grabCursor,a._grabbingCursor,d=h.browser,d.msie||d.opera?a._grabCursor=a._grabbingCursor="move":d.mozilla?(a._grabCursor="-moz-grab",a._grabbingCursor="-moz-grabbing"):e&&f&&(a._grabCursor="-webkit-grab",a._grabbingCursor="-webkit-grabbing"),this._setGrabCursor(),a._downEvent="mousedown.tds",a._moveEvent="mousemove.tds",a._upEvent="mouseup.tds",a._cancelEvent="mouseup.tds",a._clickEvent=
"click");a.hasTouch?(a._arrowControlsEnabled=!0,a._fastClick="touchstart"):(a._arrowControlsEnabled=!0,a._fastClick="click");var k='<div class="slider-wrapper"><div class="drag-container">';h.each(["center","top","right","bottom","left"],function(){k+='<div class="block '+this+'"><div class="block-inside"></div></div>'});k+="</div></div>";k+='<div class="video-overlay"><div class=" video-close-button"><a href="javascript:void();" class="hidden-video underlined">'+a._wpVars.closeVideo+'</a></div><div class="video-container"></div></div>';
k+='<div class="slider-controls">';a._arrowControlsEnabled&&(k+='<div class="arrow-left disabled-arrow"><a  href="javascript:void(0);" class="icon-bg"><span class="icon"></span><span class="info-text">'+a._wpVars.prevAlbum+'</span></a></div><div class="arrow-right"><a href="javascript:void(0);" class="icon-bg"><span class="icon"></span><span class="info-text">'+a._wpVars.nextAlbum+"</span></a></div>");(e=a._getQueryParameters().listurl)&&(k+='<div class="back-to-list-button"><a class="close-gallery-button underlined" href="'+
e+'">'+a._wpVars.backToList+"</a></div>");k+='<div class="slider-album-indicator">';k+='<div class="album-info-text"><a href="javascript:void(0);" title="Info" class="album-name-indicator underlined"></a><span class="item-count-indicator"></span></div>';k+="</div>";k+="</div>";a._galleryPostsNavigation=a.sliderRoot.find(".gallery-posts-navigation");a._lastItemLink=!1;0<a._galleryPostsNavigation.length&&(a._lastItemLink=!0);a.sliderRoot.append(k);a._slidesWrapper=a.sliderRoot.find(".slider-wrapper");
a.videoOverlay=a.sliderRoot.find(".video-overlay");a.videoContainer=a.videoOverlay.find(".video-container");a.currVideoImg="";a.isVideoPlaying=!1;a._videoCloseButton=a.videoOverlay.find(".video-close-button");a._videoCloseButton.bind("click",function(b){a.stopAndCloseVideo()});a._nextPrevActionsLocked=!1;e=a._slidesWrapper;a._dragContainer=e.find(".drag-container");a._topBlock=e.find(".top");a._leftBlock=e.find(".left");a._centerBlock=e.find(".center");a._rightBlock=e.find(".right");a._bottomBlock=
e.find(".bottom");a._albumInfoAnimating=!1;a.loadQueue;a.imageLoader;a._lastAlbumId;a._lastAlbumNumItems;a._lastItemId;a._changeHash=!1;a._imagePaddingEMs=0;a._controlsVisible=!0;a._currentMainBlockId=0;a._currentMainAlbumBlockId=0;a._tempMainBlockId=0;a._tempMainAlbumBlockId=0;a.settings.disableContextMenu&&a.sliderRoot.bind("contextmenu",function(a){a.preventDefault();a.stopImmediatePropagation();return!1});a.hasTouch?(a._lastItemFriction=0.5,a.settings.autoOpenDescription=!1):a._lastItemFriction=
0.2;a._useCSS3Transitions?g&&"moz"===l?(a.browserSufix="-moz-",a._yProp=a._xProp="-moz-transform",a.transitionEndEvent="transitionend.tds",a._use3dTransform?(a._tPref1="translate3d(",a._tPref2="px, ",a._tPref3="px, 0px)"):(a._tPref1="translate(",a._tPref2="px, ",a._tPref3="px)")):f&&a._use3dTransform?(a.browserSufix="-webkit-",a._yProp=a._xProp="-webkit-transform",a.transitionEndEvent="webkitTransitionEnd.tds",a._use3dTransform?(m||a._dragContainer.children().css({"-webkit-transform":"translateZ(0)",
"-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"}),a._dragContainer.css({"-webkit-transform":"translateZ(0px)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"}),a._tPref1="translate3d(",a._tPref2="px, ",a._tPref3="px, 0px)"):(a._tPref1="translate(",a._tPref2="px, ",a._tPref3="px)")):(a.browserSufix=/trident/i.test(navigator.userAgent)?"-ms-":"opera"in window?"-o-":"",a._yProp=a._xProp=a.browserSufix+"transform",a.transitionEndEvent=a.browserSufix+"transitionend.tds",
a._tPref1="translate(",a._tPref2="px, ",a._tPref3="px)"):(a._xProp="left",a._yProp="top",a._tPref1="",a._tPref2="",a._tPref3="",a._tPref4="");a._sliderControls=a.sliderRoot.find(".slider-controls");a._albumInfoOpen=!1;a._albumInfoAnimRunning=!1;a._headerSideMenu=h(".main-header");a._menusContainer=a._headerSideMenu.find(".menus-container");a._menusContainer=a._headerSideMenu.find(".menus-container");a.albumsArr=[];a.currAlbum;a._albumIndicator=a._sliderControls.find(".slider-album-indicator");a._albumInfoText=
a._albumIndicator.find(".album-info-text");a._albumNameIndicator=a._albumIndicator.find(".album-name-indicator");a._itemCountIndicator=a._albumIndicator.find(".item-count-indicator");a._albumInfoBlock=h('<div class="album-info-block text-block"><div class="album-info-text"></div></div>').appendTo("body");a._albumIndicator.bind("click",function(){a._toggleAlbumInfo()});if(a.settings.appendGalleriesToMenu){var p,q='<ul id="gallery-menu" class="menu">',s;a.sliderRoot.find(".two-dim-album").each(function(b,
c){p=h(c).data("start-item",0);s=p.attr("data-album-id");q+='<li data-id="'+s+'" class="menu-item"><a href="#'+s+'">'+p.find(".album-title").text()+"</a></li>";a.albumsArr.push(p)});q+="</ul>"}else a.sliderRoot.find(".two-dim-album").each(function(b,c){a.albumsArr.push(h(c).data("start-item",0))});if(0<!a.albumsArr.length)alert("Gallery error :(. No albums and images found");else{g=0;if(f=window.location.hash)f=f.replace(/^#/,""),g=a.getAlbumIdByIdAtt(f);a.currAlbum=a.albumsArr[g];a.currAlbumId=g;
a.numAlbums=a.albumsArr.length;a._arrowControlsEnabled&&(a._prevImageArr=a.sliderRoot.find(".arrow-left").click(function(b){b.preventDefault();a.prev()}),a._nextImageArr=a.sliderRoot.find(".arrow-right").click(function(b){b.preventDefault();a.next()}));a._primaryMenu=a._headerSideMenu.find(".primary-menu > .current-menu-item");a.settings.appendGalleriesToMenu&&1<a.numAlbums&&(0!=a._primaryMenu.index()&&a._primaryMenu.before('<span class="menu-sep project-menu-sep">&mdash;</span>'),q+='<span class="menu-sep project-menu-sep">&mdash;</span>',
a._primaryMenu.append(q),a._galleryMenuItems=a._primaryMenu.find("#gallery-menu").find("li"),a._galleryMenuItems.click(function(b){b.preventDefault();b.stopImmediatePropagation();b=a.getAlbumIdByIdAtt(h(this).attr("data-id"));a._moveTo(b,"y",500,!0,!0)}));a.currAlbumItems=a.currAlbum.find(".two-dim-item");a.currItemId=0;a.currAlbumNumItems=a.currAlbumItems.length;a.currAlbumScaleMode=a.currAlbum.data("img-scale");var t;h(window).bind(a._orientationChangeEvent,function(){t&&clearTimeout(t);t=setTimeout(function(){a.updateSliderSize()},
35)});a.updateSliderSize();a.updateContents();a._slidesWrapper.bind(a._downEvent,function(b){a._onDragStart(b)});a.settings.keyboardNavEnabled&&h(document).keydown(function(b){a._isDragging||a._isAnimating||(37===b.keyCode?(b.preventDefault(),a.prev()):39===b.keyCode?(b.preventDefault(),a.next()):40===b.keyCode?(b.preventDefault(),a.nextAlbum()):38===b.keyCode?(b.preventDefault(),a.prevAlbum()):73===b.keyCode&&a._toggleAlbumInfo())});h("body").bind("mouseleave",function(b){a._isDragging&&a._onDragRelease(b)});
a.hasTouch||a.sliderRoot.bind("mousewheel",function(b,c,d,e){0>c?a.next():0<c&&a.prev()});a._changedByHash=!1;a._ignoreHashChange=!1;a._hashTimeout;a._unblockHashChange();a.hasTouch&&(h.idleTimer(a.hasTouch?4E3:2E3,document,{events:"mousemove touchend mouseup"}),h(document).bind("idle.idleTimer",function(){a._albumInfoOpen||a._hideAllControls()}));a.settings.autoOpenDescription&&900<a.sliderWidth&&(a._showAlbumInfo(),a._fadeOut(a._albumIndicator),a.albumsArr[a.currAlbumId].data("sawInfo",!0))}}v.prototype=
{getAlbumIdByIdAtt:function(b){for(var c=this.albumsArr,d=0;d<c.length;d++)if(c[d].attr("data-album-id")===b)return d;return 0},_blockHashChange:function(){h(window).unbind("hashchange.tds")},_updateAlbumHash:function(){this._updateHash(this.albumsArr[this.currAlbumId].attr("data-album-id"))},_unblockHashChange:function(){var b=this;h(window).bind("hashchange.tds",function(c){c=location.hash;c=c.replace(/^#/,"");c=b.getAlbumIdByIdAtt(c);b._moveTo(c,"y",500)})},_updateHash:function(b){var c=this;c._blockHashChange();
window.location.hash=b;c._hashTimeout&&clearTimeout(c._hashTimeout);c._hashTimeout=setTimeout(function(){c._unblockHashChange()},60)},_doBackAndForthAnim:function(b){function c(){d._isAnimating=!1}var d=this,a,f,g,h=Math.max(d._xDistToSnap,130)/3;d._currAnimSpeed=200;"bottom"===b?(a=d._tempMainAlbumBlockId*d.sliderHeight,f="y",g=-h):"top"===b?(a=d._tempMainAlbumBlockId*d.sliderHeight,f="y",g=h):"right"===b?(a=d._tempMainBlockId*d.sliderWidth,f="x",g=-h):"left"===b&&(a=d._tempMainBlockId*d.sliderWidth,
f="x",g=h);if(d._lastItemLink&&(b="left"===b||"top"===b?d._galleryPostsNavigation.find("a[rel=next]").attr("href"):d._galleryPostsNavigation.find("a[rel=prev]").attr("href"))){window.location.href=b;return}d._animateTo(a+g,"",f,!1,!0,function(){d._isAnimating=!1;d._animateTo(a,"",f,!1,!0,c)})},_moveTo:function(b,c,d,a,f,g){if(this._isDragging||this._isAnimating)return!1;this.isVideoPlaying&&this.stopAndCloseVideo();this._changeHash="y"===c&&a?!0:!1;if("x"===c)if("next"===b){if(!this._loopItems&&this.currItemId+
1>=this.currAlbumNumItems)return this._doBackAndForthAnim("right"),!1;this._hideAlbumInfo();this._tempMainBlockId=this._currentMainBlockId-1;this._updateCurrItemId(this.currAlbumId,this.currItemId+1);b=this._rightBlock;this._rightBlock=this._leftBlock;this._leftBlock=this._centerBlock;this._centerBlock=b;b=this._tempMainBlockId*this.sliderWidth;this._currAnimSpeed=d;this._animateTo(b,"next","x",!1,f)}else if("prev"===b){if(!this._loopItems&&0>this.currItemId-1)return this._doBackAndForthAnim("left"),
!1;this._hideAlbumInfo();this._tempMainBlockId=this._currentMainBlockId+1;this._updateCurrItemId(this.currAlbumId,this.currItemId-1);b=this._centerBlock;this._centerBlock=this._leftBlock;this._leftBlock=this._rightBlock;this._rightBlock=b;b=this._tempMainBlockId*this.sliderWidth;this._currAnimSpeed=d;this._animateTo(b,"prev","x",!1,f)}else a=parseInt(b,10),a===this.currItemId+1?this._moveTo("next","x",d):a===this.currAlbumId-1?this._moveTo("prev","x",d):a>this.currItemId?(this._tempMainBlockId=this._currentMainBlockId-
1,this._updateCurrItemId(this.currAlbumId,currItemId),b=this._rightBlock,this._rightBlock=this._leftBlock,this._leftBlock=this._centerBlock,this._centerBlock=b,b=this._tempMainBlockId*this.sliderWidth,this._currAnimSpeed=d,this._centerBlock.find("img").css("visibility","hidden"),this._animateTo(b,"next","x",!0,f)):a<this.currItemId&&(this._tempMainAlbumBlockId=this._currentMainAlbumBlockId+1,this._updateCurrItemId(this.currAlbumId,currItemId),b=this._centerBlock,this._centerBlock=this._leftBlock,
this._leftBlock=this._rightBlock,this._rightBlock=b,b=this._tempMainAlbumBlockId*this.sliderHeight,this._currAnimSpeed=d,this._centerBlock.find("img").css("visibility","hidden"),this._animateTo(b,"prev","x",!0,f));else if("next"===b){if(!this._loopAlbums&&this.currAlbumId+1>=this.numAlbums)return g?this._doBackAndForthAnim("right"):this._doBackAndForthAnim("bottom"),!1;this._hideAlbumInfo();this._tempMainAlbumBlockId=this._currentMainAlbumBlockId-1;this._updateCurrItemId(this.currAlbumId+1,0);a=this._getAlbum(this.currAlbumId);
this.currItemId=a.data("start-item");b=this._bottomBlock;this._bottomBlock=this._topBlock;this._topBlock=this._centerBlock;this._centerBlock=b;b=this._tempMainAlbumBlockId*this.sliderHeight;this._currAnimSpeed=d;this._animateTo(b,"next","y",!1,f)}else if("prev"===b){if(!this._loopAlbums&&0>this.currAlbumId-1)return g?this._doBackAndForthAnim("left"):this._doBackAndForthAnim("top"),!1;this._hideAlbumInfo();this._tempMainAlbumBlockId=this._currentMainAlbumBlockId+1;this._updateCurrItemId(this.currAlbumId-
1,0);a=this._getAlbum(this.currAlbumId);this.currItemId=a.data("start-item");b=this._centerBlock;this._centerBlock=this._topBlock;this._topBlock=this._bottomBlock;this._bottomBlock=b;b=this._tempMainAlbumBlockId*this.sliderHeight;this._currAnimSpeed=d;this._animateTo(b,"prev","y",!1,f)}else b=parseInt(b,10),b===this.currAlbumId+1?this._moveTo("next","y",d,a,f):b===this.currAlbumId-1?this._moveTo("prev","y",d,a,f):b>this.currAlbumId?(this._tempMainAlbumBlockId=this._currentMainAlbumBlockId-1,this._updateCurrItemId(b,
0),a=this._getAlbum(this.currAlbumId),this.currItemId=a.data("start-item"),b=this._bottomBlock,this._bottomBlock=this._topBlock,this._topBlock=this._centerBlock,this._centerBlock=b,b=this._tempMainAlbumBlockId*this.sliderHeight,this._currAnimSpeed=d,this._updateAlbumBackground(this._centerBlock,a.data("bg"),this.currAlbumId),this._centerBlock.find(".play-button-container").remove(),this._centerBlock.find("img").css("visibility","hidden"),this._animateTo(b,"next","y",!0,f)):b<this.currAlbumId&&(this._tempMainAlbumBlockId=
this._currentMainAlbumBlockId+1,this._updateCurrItemId(b,0),a=this._getAlbum(this.currAlbumId),this.currItemId=a.data("start-item"),b=this._centerBlock,this._centerBlock=this._topBlock,this._topBlock=this._bottomBlock,this._bottomBlock=b,b=this._tempMainAlbumBlockId*this.sliderHeight,this._currAnimSpeed=d,this._updateAlbumBackground(this._centerBlock,a.data("bg"),this.currAlbumId),this._centerBlock.find(".play-button-container").remove(),this._centerBlock.find("img").css("visibility","hidden"),this._animateTo(b,
"prev","y",!0,f));this._updateControls(c)},next:function(){this._nextPrevActionsLocked||(this._nextPrevActionsLocked=!0,this.currItemId+1>=this.currAlbumNumItems&&this.currAlbumId<this.numAlbums-1?this._moveTo("next","y",this.settings.transitionSpeed,!0,!0):this._moveTo("next","x",this.settings.transitionSpeed,!0,!0),this._nextPrevActionsLocked=!1)},prev:function(){this._nextPrevActionsLocked||(this._nextPrevActionsLocked=!0,!this._loopItems&&0>this.currItemId-1&&0!=this.currAlbumId?this._moveTo("prev",
"y",this.settings.transitionSpeed,!0,!0):this._moveTo("prev","x",this.settings.transitionSpeed,!0,!0),this._nextPrevActionsLocked=!1)},nextItem:function(){this._moveTo("next","x",this.settings.transitionSpeed,!0,!0)},prevItem:function(){this._moveTo("prev","x",this.settings.transitionSpeed,!0,!0)},nextAlbum:function(){this._moveTo("next","y",this.settings.transitionSpeed,!0,!0)},prevAlbum:function(){this._moveTo("prev","y",this.settings.transitionSpeed,!0,!0)},_updateAlbumBackground:function(b,c,
d){b.data("bg-album-id")!==d&&(b.data("bg-album-id",d),b.css("background",c))},_onDragStart:function(b){var c=this;if(c._isAnimating)return b.preventDefault(),!1;if(c._isDragging)c.hasTouch&&(c._multipleTouches=!0);else{c.hasTouch&&(c._multipleTouches=!1);c._useCSS3Transitions&&c._dragContainer.css(c.browserSufix+"transition-duration","0s");c._setGrabbingCursor();c._isDragging=!0;var d;if(c.hasTouch){var a=b.originalEvent.touches;if(a&&0<a.length)d=a[0],1<a.length&&(c._multipleTouches=!0);else return!1}else d=
b,b.preventDefault();h(document).bind(c._moveEvent,function(a){c._onDragMove(a)});h(document).bind(c._upEvent,function(a){c._onDragRelease(a)});c._isVerticalNav=!1;c._currMoveAxis="";c.moved=!1;c.pointX=c._accelerationX=c.startX=d.pageX;c.pointY=c._accelerationY=c.startY=d.pageY;c.changedX=0;c.changedY=0;c.horDirection=0;c.verDirection=0;c.directionLocked=!1;c._startTime=b.timeStamp||(new Date).getTime();c._moveDist=0;c.hasTouch&&c._slidesWrapper.bind(c._cancelEvent,function(a){c._onDragRelease(a)})}},
_onDragMove:function(b){var c;if(this.hasTouch)if(c=b.originalEvent.touches){if(1<c.length)return!1;c=c[0]}else return!1;else c=b;b.preventDefault();b=b.timeStamp||(new Date).getTime();var d=c.pageX-this.pointX,a=c.pageY-this.pointY;this.changedX+=Math.abs(d);this.changedY+=Math.abs(a);if(!(10>this.changedY&&7>this.changedX)){var f=this.x+d,g=this.y+a;this.moved=!0;this.pointX=c.pageX;this.pointY=c.pageY;var h=this._currMoveAxis;"x"===h?0!==d&&(this.horDirection=0<d?1:-1):"y"===h?0!==a&&(this.verDirection=
0<a?1:-1):this.changedY>this.changedX?(this._isVerticalNav=!0,this._currMoveAxis="y",this.verDirection=0<a?1:-1):(this._currMoveAxis="x",this.horDirection=0<d?1:-1);this._isVerticalNav?(this._loopAlbums||(0>=this.currAlbumId&&0<c.pageY-this.startY&&(g=this.y+a*this._lastItemFriction),this.currAlbumId>=this.numAlbums-1&&0>c.pageY-this.startY&&(g=this.y+a*this._lastItemFriction)),this._setPosition(g,"y"),200<b-this._startTime&&(this._startTime=b,this._accelerationY=c.pageY)):(this._loopItems||(0>=this.currItemId&&
0<c.pageX-this.startX&&(f=this.x+d*this._lastItemFriction),this.currItemId>=this.currAlbumNumItems-1&&0>c.pageX-this.startX&&(f=this.x+d*this._lastItemFriction)),this._setPosition(f,"x"),200<b-this._startTime&&(this._startTime=b,this._accelerationX=c.pageX));return!1}},_onDragRelease:function(b){function c(a){return 200>a?200:500<a?500:a}function d(b,d,f){m="x"===b?a._currentMainBlockId*a.sliderWidth:a._currentMainAlbumBlockId*a.sliderHeight;e=Math.abs(a[b]-m);a._currAnimSpeed=e/f;d&&(a._currAnimSpeed+=
250);a._currAnimSpeed=c(a._currAnimSpeed);a._animateTo(m,!1,b)}var a=this,f=a.hasTouch?b.originalEvent.changedTouches[0]:b,g,m,e;a._isDragging=!1;h(document).unbind(a._moveEvent);h(document).unbind(a._upEvent);a.hasTouch&&a._slidesWrapper.unbind(a._cancelEvent);a._setGrabCursor();if(a.moved||a._multipleTouches){g=Math.max(30,b.timeStamp||(new Date).getTime())-a._startTime;if(a._isVerticalNav){b="y";var f=f.pageY,n=a.startY,l=a._accelerationY,r=a.currAlbumId,k=a.numAlbums,p=a.verDirection,q=a.sliderHeight,
s=a._currentMainAlbumBlockId,t=a._loopAlbums,u=!0}else b="x",f=f.pageX,n=a.startX,l=a._accelerationX,r=a.currItemId,k=a.currAlbumNumItems,p=a.horDirection,q=a.sliderWidth,s=a._currentMainBlockId,t=a._loopItems,u=!1;Math.abs(f-n);g=Math.abs(f-l)/g;if(0===p||1>=k)return d(b,!0,g),!1;if(!t)if(0>=r){if(0<p)return d(b,!0,g),!1}else if(r>=k-1&&0>p)return d(b,!0,g),!1;if(n+0<f){if(0>p)return d(b,!1,g),!1;a._moveTo("prev",b,c(Math.abs(a[b]-(s+1)*q)/g),u)}else if(n-0>f){if(0<p)return d(b,!1,g),!1;a._moveTo("next",
b,c(Math.abs(a[b]-(s-1)*q)/g),u)}else d(b,!1,g);return!1}a._albumInfoOpen?a._hideAlbumInfo():a.hasTouch?a._controlsVisible?a._hideAllControls():a._showAllControls():h(b.target).hasClass("play-button-icon")||a.next()},_addItemToLoadQueue:function(b,c,d,a){var f=this._getAlbum(d);"start-item"===a&&(a=f.data("start-item"));if(a=this._getItem(d,a)){c.hasClass("last-block")&&c.removeClass("last-block");var g=a.data("img-scale");g||(g=f.data("img-scale"),a.data("img-scale",g));b.push({block:c,item:a,bgColor:f.data("bg"),
albumId:d})}else c.addClass("last-block")},_animateTo:function(b,c,d,a,f,g){function h(){var b=[],f;c&&("x"===d?(e._addItemToLoadQueue(b,e._centerBlock,e.currAlbumId,e.currItemId),e._currentMainBlockId=e._tempMainBlockId,"next"===c?(e._rightBlock.css("left",100*-e._currentMainBlockId+100+"%"),e._addItemToLoadQueue(b,e._rightBlock,e.currAlbumId,e.currItemId+1)):"prev"===c&&(e._leftBlock.css("left",100*-e._currentMainBlockId-100+"%"),e._addItemToLoadQueue(b,e._leftBlock,e.currAlbumId,e.currItemId-1)),
e._topBlock.css("left",100*-e._currentMainBlockId+"%"),e._bottomBlock.css("left",100*-e._currentMainBlockId+"%"),f=e._getAlbum(e.currAlbumId),f.data("start-item",e.currItemId),e._addItemToLoadQueue(b,e._bottomBlock,e.currAlbumId+1,"start-item"),e._addItemToLoadQueue(b,e._topBlock,e.currAlbumId-1,"start-item")):(f=e._getAlbum(e.currAlbumId),e.currItemId=f.data("start-item"),e._addItemToLoadQueue(b,e._centerBlock,e.currAlbumId,e.currItemId),e._addItemToLoadQueue(b,e._rightBlock,e.currAlbumId,e.currItemId+
1),e._currentMainAlbumBlockId=e._tempMainAlbumBlockId,"next"===c?(e._bottomBlock.css("top",100*-e._currentMainAlbumBlockId+100+"%"),e._addItemToLoadQueue(b,e._bottomBlock,e.currAlbumId+1,"start-item"),a&&e._addItemToLoadQueue(b,e._topBlock,e.currAlbumId-1,"start-item")):(e._topBlock.css("top",100*-e._currentMainAlbumBlockId-100+"%"),e._addItemToLoadQueue(b,e._topBlock,e.currAlbumId-1,"start-item"),a&&e._addItemToLoadQueue(b,e._bottomBlock,e.currAlbumId+1,"start-item")),e._leftBlock.css("top",100*
-e._currentMainAlbumBlockId+"%"),e._rightBlock.css("top",100*-e._currentMainAlbumBlockId+"%"),e._addItemToLoadQueue(b,e._leftBlock,e.currAlbumId,e.currItemId-1)),e._updateImageQueue(b));e._changeHash&&e._updateAlbumHash();setTimeout(function(){e._isAnimating=!1;e.onTransitionComplete.call(e);e._changeHash&&e._setGrabCursor();e.settings.autoOpenDescription&&900<e.sliderWidth?e._collapsedSlider||(0!==e.currItemId||e.albumsArr[e.currAlbumId].data("sawInfo")?e._fadeIn(e._albumIndicator):(e._showAlbumInfo(),
e.albumsArr[e.currAlbumId].data("sawInfo",!0))):e._fadeIn(e._albumIndicator)},30)}var e=this,n;e.onTransitionStart.call(e);e._isAnimating=!0;e[d]=b;n="x"===d?e._xProp:e._yProp;var l={};isNaN(e._currAnimSpeed)&&(e._currAnimSpeed=400);e._useCSS3Transitions?(l[e.browserSufix+"transition-duration"]=e._currAnimSpeed+"ms",l[e.browserSufix+"transition-property"]=e.browserSufix+"transform",l[e.browserSufix+"transition-timing-function"]=void 0!=f?e.settings.css3easeInOutEasing:"cubic-bezier(0.390, 0.575, 0.565, 1.000)",
e._dragContainer.css(l),e._dragContainer.css(n,e._tPref1+e.x+e._tPref2+e.y+e._tPref3)):(l[n]=b,e._dragContainer.animate(l,e._currAnimSpeed,f?e.settings.easeInOutEasing:"easeOutSine"));e.loadingTimeout=g?setTimeout(function(){g.call()},e._currAnimSpeed+50):setTimeout(function(){h()},e._currAnimSpeed+50)},_setPosition:function(b,c){this._useCSS3Transitions?"y"===c?(this.y=b,this._dragContainer.css(this._yProp,this._tPref1+this.x+this._tPref2+this.y+this._tPref3)):(this.x=b,this._dragContainer.css(this._xProp,
this._tPref1+this.x+this._tPref2+this.y+this._tPref3)):"y"===c?(this.y=b,this._dragContainer.css(this._yProp,this.y)):(this.x=b,this._dragContainer.css(this._xProp,this.x))},updateSliderSize:function(){var b=window.innerWidth||document.body.clientWidth,c=this._slidesWrapper.width(),d=this._slidesWrapper.height();if(c!=this.sliderWidth||d!=this.sliderHeight){this.sliderWidth=c;this.sliderHeight=d;this._yDistToSnap=this._xDistToSnap=1;600>this.sliderWidth?(this._collapsedSlider=!0,this.sliderRoot.addClass("smaller-collapsed-slider")):
(this._collapsedSlider=!1,this.sliderRoot.removeClass("smaller-collapsed-slider"));850<=b?(this._imagePaddingEMs="2",this._controlsVisible||this._showAllControls()):850>b&&(this._imagePaddingEMs=700<b?"1":"0");this._useCSS3Transitions&&this._dragContainer.css(this.browserSufix+"transition-duration","0s");b=[this._centerBlock,this._leftBlock,this._rightBlock,this._bottomBlock,this._topBlock];for(d=0;d<b.length;d++)(c=b[d].find("img"))&&this._resizeImage(c,c.data("img-width"),c.data("img-height"));
this._setPosition(this._currentMainBlockId*this.sliderWidth,"x");this._setPosition(this._currentMainAlbumBlockId*this.sliderHeight,"y");this.isVideoPlaying&&(b=this.videoContainer.find(".video-player"),c=this._resizeImage("",this.settings.maxVideoWidth,this.settings.maxVideoHeight,!0),b.css({"margin-left":c.left,"margin-top":c.top,width:c.width,height:c.height}),b.removeAttr("width"))}},updateContents:function(){this.currAlbumItems.eq(this.currItemId);var b=[];this._addItemToLoadQueue(b,this._centerBlock,
this.currAlbumId,this.currItemId);this._addItemToLoadQueue(b,this._rightBlock,this.currAlbumId,this.currItemId+1);this._addItemToLoadQueue(b,this._leftBlock,this.currAlbumId,this.currItemId-1);this._addItemToLoadQueue(b,this._bottomBlock,this.currAlbumId+1,0);this._addItemToLoadQueue(b,this._topBlock,this.currAlbumId-1,0);this._updateImageQueue(b);this._getAlbum(this.currAlbumId).data("start-item",this.currItemId);this._updateControls()},_getItem:function(b,c){var d;if(0>b){if(!this._loopAlbums)return!1;
b=this.numAlbums-1}else if(b>=this.numAlbums){if(!this._loopAlbums)return!1;b=0}var a=this.albumsArr[b];if(a){var f=a.find(".two-dim-item");if(f){d=f.length;if(0>=d)return 0;if(0>c){if(!this._loopItems)return!1;c=d-1}else if(c>=d){if(!this._loopItems)return!1;c=0}d=f.eq(c)}d.find("img").data("img-scale",a.data("img-scale"))}return d},_updateCurrItemId:function(b,c){this._lastAlbumId=this.currAlbumId;this._lastAlbumNumItems=this.currAlbumNumItems;this._lastItemId=this.currItemId;0>b?b=this.numAlbums-
1:b>=this.numAlbums&&(b=0);this.currAlbumId=b;var d=this.albumsArr[b];if(d){if(d=d.find(".two-dim-item")){d=d.length;if(0>=d)return 0;this.currAlbumNumItems=d;0>c?c=d-1:c>=d&&(c=0)}this.currItemId=c}else alert("Album is empty:"+b+" id:"+c)},_updateControls:function(b){var c=this;"y"===b?1<c.numAlbums&&0<=c.currAlbumId&&(c.settings.appendGalleriesToMenu&&(c._galleryMenuItems.removeClass("current-album-menu-item"),c._galleryMenuItems.eq(c.currAlbumId).addClass("current-album-menu-item")),c._collapsedSlider||
c._fadeOut(c._albumIndicator),setTimeout(function(){c._itemCountIndicator.text(""+(c.currItemId+1)+" of "+c.currAlbumNumItems);c._albumNameIndicator.text(c.albumsArr[c.currAlbumId].find(".album-title").text())},400),c._updateAlbumIndicator(),c._updateItemControls()):("x"!==b&&(c._galleryMenuItems&&c._galleryMenuItems.eq(c.currAlbumId).addClass("current-album-menu-item"),c._updateAlbumIndicator(),c._albumNameIndicator.text(c.albumsArr[c.currAlbumId].find(".album-title").text())),c._itemCountIndicator.text(""+
(c.currItemId+1)+" of "+c.currAlbumNumItems),c._updateItemControls())},_updateItemControls:function(){this._arrowControlsEnabled&&(this._prevImageArr.hasClass("disabled-arrow")&&this._prevImageArr.removeClass("disabled-arrow"),this._nextImageArr.hasClass("disabled-arrow")&&this._nextImageArr.removeClass("disabled-arrow"),0>=this.currItemId?0<this.currAlbumId?this._prevImageArr.hasClass("prev-album-arrow")||this._prevImageArr.addClass("prev-album-arrow").find(".info-text").addClass("info-text-visible"):
this._lastItemLink&&this._galleryPostsNavigation.find("a[rel=next]").attr("href")?this._prevImageArr.addClass("prev-album-arrow").find(".info-text").addClass("info-text-visible"):this._prevImageArr.addClass("disabled-arrow").find(".info-text").removeClass("info-text-visible"):this._prevImageArr.hasClass("prev-album-arrow")&&this._prevImageArr.removeClass("prev-album-arrow").find(".info-text").removeClass("info-text-visible"),this.currItemId>=this.currAlbumNumItems-1?this.currAlbumId<this.numAlbums-
1?this._nextImageArr.hasClass("next-album-arrow")||this._nextImageArr.addClass("next-album-arrow").find(".info-text").addClass("info-text-visible"):this._lastItemLink&&this._galleryPostsNavigation.find("a[rel=prev]").attr("href")?this._nextImageArr.addClass("next-album-arrow").find(".info-text").addClass("info-text-visible"):this._nextImageArr.addClass("disabled-arrow").find(".info-text").removeClass("info-text-visible"):this._nextImageArr.hasClass("next-album-arrow")&&this._nextImageArr.removeClass("next-album-arrow").find(".info-text").removeClass("info-text-visible"))},
_updateAlbumIndicator:function(){},_getAlbum:function(b){0>b?b=this.numAlbums-1:b>=this.numAlbums&&(b=0);return this.albumsArr[b]},_updateImageQueue:function(b){if(b){for(var c,d,a,f,g=0;g<b.length;g++)c=b[g],f=c.block,a=c.item.data(),c.item?(d=f.find("img"),(a=Boolean(void 0!==a.videoUrl))||f.find(".play-button-container").remove(),a=c.item.find("a").attr("href"),d.attr("src")!==a?d.css("visibility","hidden"):c.block.hasClass("loading")||d.css("visibility","visible"),this._updateAlbumBackground(f,
c.bgColor,c.albumId)):(b.splice(g,1),g--);this.isLoading=!0}this.loadQueue=b;this._loadNextImage()},_onLoadingComplete:function(b){var c=this;return function(){var d=b.img,a=b.loadDataItem.item.data(),f=b.block.find(".block-inside"),a=Boolean(void 0!==a.videoUrl);d.data("blocked-by-loop")||d.css({visibility:"visible"});a?0<!f.find(".play-button-container").length&&(f.append('<a class="play-button-container"><span class="play-button"><i class="play-icons-wrap"><u class="play-button-icon"></u><u class="play-video-loading-icon"></u></i></snan></a>'),
f.find(".play-button-container").bind("click",function(a){if(c.moved)return!1;a.preventDefault();a.stopImmediatePropagation();c._controlsVisible=!0;c._showVideo(b,f)})):0<f.find(".play-button-container").length&&(f.find("img").css("cursor","inherit").unbind("click"),f.find(".play-button-container").unbind("click"),f.find(".play-button-container").remove());b.block.removeClass("loading");b.block.find(".preloader-container").remove();d.unbind("error.tds");d.unbind("load.tds");!c.firstLoaded&&c.settings.firstImageLoadedCallback&&
(c.settings.firstImageLoadedCallback.call(c),c.firstLoaded=!0);1<c.loadQueue.length?(c.loadQueue.shift(),c._loadNextImage()):c.isLoading=!1}},_loadNextImage:function(){var b=this.loadQueue[0];if(b){var c=b.item;if(c){var d=b.block,a=d.find("img").eq(0),f=c.find("a").attr("href"),g=c.attr("data-img-width"),m=c.attr("data-img-height");0>=a.length?(hasImage=!1,a=h("<img />"),currBlockPath=""):(hasImage=!0,currBlockPath=a.attr("src"));a.data({"img-width":g,"img-height":m,"img-scale":c.data("img-scale")});
currBlockPath===f?d.hasClass("loading")||(1<this.loadQueue.length?(this.loadQueue.shift(),this._loadNextImage()):this.isLoading=!1):this.imageLoader&&this.imageLoader.attr("src")==f?(this._resizeImage(a,g,m),this._onLoadingComplete({type:"loaded",item:c,block:d})):(d.addClass("loading"),d.append('<div class="preloader-container"><div class="preloader-spinner"></div></div>'),a.css("visibility","hidden").bind("load.tds",this._onLoadingComplete({type:"loaded",loadDataItem:b,block:d,img:a})).bind("error.tds",
this._onLoadingComplete({type:"error",loadDataItem:b,block:d,img:a})).attr({src:f,alt:c.find("a").text()}),hasImage||a.appendTo(d.find(".block-inside")),this._resizeImage(a,g,m))}}},_resizeImage:function(b,c,d,a){imgScaleMode=a?"fit-if-smaller":b.data("img-scale");a||(c=parseInt(c,10),d=parseInt(d,10));a?(this.imgWrapWidth=this.videoContainer.width(),this.imgWrapHeight=this.videoContainer.height()):(a="fill"!==imgScaleMode?this._imagePaddingEMs+"em":"0",a=b.parent(".block-inside").css("margin",a),
this.imgWrapWidth=a.width(),this.imgWrapHeight=a.height());a=this.imgWrapWidth;var f=this.imgWrapHeight,g,h;"fit-if-smaller"===imgScaleMode&&(c>a||d>f)&&(imgScaleMode="fit");if("fill"===imgScaleMode||"fit"===imgScaleMode)g=a/c,h=f/d,g="fill"==imgScaleMode?g>h?g:h:"fit"==imgScaleMode?g<h?g:h:1,c=parseInt(c*g,10),d=parseInt(d*g,10);if(b)b.css({"margin-left":Math.floor((a-c)/2),"margin-top":Math.floor((f-d)/2),width:c,height:d});else return{width:c,height:d,left:Math.floor((a-c)/2),top:Math.floor((f-
d)/2)}},_setGrabCursor:function(){this.hasTouch||(this._grabCursor?this._slidesWrapper.css("cursor",this._grabCursor):(this._slidesWrapper.removeClass("grabbing-cursor"),this._slidesWrapper.addClass("grab-cursor")))},_setGrabbingCursor:function(){this.hasTouch||(this._grabbingCursor?this._slidesWrapper.css("cursor",this._grabbingCursor):(this._slidesWrapper.removeClass("grab-cursor"),this._slidesWrapper.addClass("grabbing-cursor")))},_showVideo:function(b,c){if(this.isVideoPlaying)return!1;var d=
b.loadDataItem.item.data();if(void 0!==d.videoUrl)if(d=d.videoUrl,d.match(/youtu\.be/i)||d.match(/youtube\.com\/watch/i))if(d=this._getYoutubeVideoId(d)){this.isVideoPlaying=!0;d="http://www.youtube.com/embed/"+d+"?rel=1";this.settings.autoplayVideo&&(d+="&autoplay=1&showinfo=0");c.find(".play-button").addClass("play-button-loading");this._fadeInVideo(b.loadDataItem.block);d=h('<iframe class="video-player" src ="'+d+'" frameborder="no"></iframe>');this.videoOverlay.css("display","block");var a=this._resizeImage("",
this.settings.maxVideoWidth,this.settings.maxVideoHeight,!0);d.css({"margin-left":a.left,"margin-top":a.top,width:a.width,height:a.height});this._videoCloseButton.removeClass("hidden-video");this.videoContainer.append(d)}else alert("Incorrect YouTube URL syntax");else d.match(/vimeo\.com/i)?(d=this._getVimeoVideoId(d),this.isVideoPlaying=!0,d="http://player.vimeo.com/video/"+d+"?title=0&amp;byline=0&amp;portrait=0",this.settings.autoplayVideo&&(d+="&autoplay=1"),c.find(".play-button").addClass("play-button-loading"),
this._fadeInVideo(b.loadDataItem.block),d=h('<iframe class="video-player" src ="'+d+'" frameborder="no"></iframe>'),this.videoOverlay.css("display","block"),a=this._resizeImage("",this.settings.maxVideoWidth,this.settings.maxVideoHeight,!0),d.css({"margin-left":a.left,"margin-top":a.top,width:a.width,height:a.height}),this._videoCloseButton.removeClass("hidden-video"),this.videoContainer.append(d)):alert("Incorrect video URL: "+d)},stopAndCloseVideo:function(){this._videoCloseButton.addClass("hidden-video");
this.videoOverlay.css("display","none");this.videoContainer.find("iframe").remove();var b=this._centerBlock.find("img");0<b.length&&b.animate({opacity:1},400,"easeOutSine");this._centerBlock.find(".play-button-loading").removeClass("play-button-loading");this.isVideoPlaying=!1;this._showAllControls()},_fadeInVideo:function(b){this._albumInfoOpen&&this._toggleAlbumInfo();b=b.find("img");0<b.length&&b.animate({opacity:0},400,"easeOutSine");this._hideAllControls()},_showAllControls:function(){this._controlsVisible||
(this._fadeIn(this._headerSideMenu),this._controlsVisible=!0,this._fadeIn(this._sliderControls))},_hideAllControls:function(){this._controlsVisible&&(this._albumInfoOpen&&this._toggleAlbumInfo(),this._headerSideMenu.hasClass("collapsed-gallery-page-menu")&&this._fadeOut(this._headerSideMenu),this._fadeOut(this._sliderControls),this._controlsVisible=!1)},_fadeOut:function(b,c){setTimeout(function(){b.stop().animate({opacity:0},300,function(){b.css("display","none");c&&c.call()})},0)},_fadeIn:function(b,
c){b.stop().css("display","block");setTimeout(function(){b.animate({opacity:1},300,function(){c&&c.call()})},0)},_getVimeoVideoId:function(b){return(b=b.match(/\/\/(www\.)?vimeo.com\/(\d+)($|\/)/))?b[2]:!1},_getYoutubeVideoId:function(b){return(b=b.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/))&&11==b[7].length?b[7]:!1},_showAlbumInfo:function(){var b=this;if(!b._albumInfoOpen){if(b._albumInfoBlock.data("curr-album-id")!==b.currAlbumId){var c=b.albumsArr[b.currAlbumId].find(".album-meta"),
d='<div class="info-container">'+c.html(),c=c.find(".album-title a"),a=c.attr("href"),c=c.html(),f=b._getItem(b.currAlbumId,0).find("a").attr("href"),d=d+'<div class="bottom-bar clearfix"><div class="share-project">'+('<a href="http://pinterest.com/pin/create/button/?url='+a+"&media="+f+"&description="+c+'" class="pin-it-btn"></a>'),d=d+('<a class="facebook-share-btn" href="http://www.facebook.com/sharer/sharer.php?u='+a+'">'),d=d+"</a>",d=d+('<a href="javascript:void(0);" class="close-project">'+
b._wpVars.closeProjectInfo+"</a>"),d=d+"</div>",d=d+"</div>";b._albumInfoBlock.html(d);d=b._albumInfoBlock.find(".album-title a");d.replaceWith(d.text());b._albumInfoBlock.find(".close-project").bind("click",function(a){a.preventDefault();b._hideAlbumInfo()});b._albumInfoBlock.find(".pin-it-btn, .facebook-share-btn").click(function(a){a.preventDefault();window.open(h(this).attr("href"),"signin","width=665,height=300")});"undefined"!=typeof FB&&null!=FB&&FB.XFBML.parse(b._albumInfoBlock.get(0));b._albumInfoBlock.data("curr-album-id",
b.currAlbumId)}b._fadeIn(b._albumInfoBlock);b._fadeOut(b._albumIndicator);b._albumInfoOpen=!0}},_hideAlbumInfo:function(){var b=this;b._albumInfoOpen&&(b._albumInfoAnimating=!0,b._fadeOut(b._albumInfoBlock,function(){b._albumInfoAnimating=!1}),b._fadeIn(b._albumIndicator),b._albumInfoOpen=!1)},_toggleAlbumInfo:function(){this._albumInfoOpen?this._hideAlbumInfo():this._showAlbumInfo()},_updateMenuSize:function(){var b=window.innerWidth||document.body.clientWidth;this._isMenuVisible&&(this._isMenuCollapsed=
!0,600<b?this._headerSideMenu.css("width","50%"):this._headerSideMenu.css("width","100%"))},_getQueryParameters:function(){var b=window.location.href.split("?")[1];if(!b)return{};for(var b=b.split("&"),c={},d=0,a=b.length;d<a;d++){var f=b[d].split("=");c[f[0]]=f[1]}return c}};h.fn.twoDimSlider=function(b){return this.each(function(){var c=new v(h(this),b);h(this).data("twoDimSlider",c)})};h.fn.twoDimSlider.defaults={keyboardNavEnabled:!0,transitionSpeed:600,autoplayVideo:!0,maxVideoWidth:800,maxVideoHeight:600,
openInfoBlockAtStart:!1,disableContextMenu:!1,easeInOutEasing:"easeInOutSine",css3easeInOutEasing:"cubic-bezier(0.445, 0.050, 0.550, 0.950)",firstImageLoadedCallback:!1,appendGalleriesToMenu:!1,autoOpenDescription:Boolean(tdSliderVars.autoOpenProjectDesc)};h.fn.twoDimSlider.settings={}})(jQuery);

/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function($){var c=['DOMMouseScroll','mousewheel'];if($.event.fixHooks){for(var i=c.length;i;){$.event.fixHooks[c[--i]]=$.event.mouseHooks}}$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=c.length;i;){this.addEventListener(c[--i],handler,false)}}else{this.onmousewheel=handler}},teardown:function(){if(this.removeEventListener){for(var i=c.length;i;){this.removeEventListener(c[--i],handler,false)}}else{this.onmousewheel=null}}};$.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}});function handler(a){var b=a||window.event,args=[].slice.call(arguments,1),delta=0,returnValue=true,deltaX=0,deltaY=0;a=$.event.fix(b);a.type="mousewheel";if(b.wheelDelta){delta=b.wheelDelta/120}if(b.detail){delta=-b.detail/3}deltaY=delta;if(b.axis!==undefined&&b.axis===b.HORIZONTAL_AXIS){deltaY=0;deltaX=-1*delta}if(b.wheelDeltaY!==undefined){deltaY=b.wheelDeltaY/120}if(b.wheelDeltaX!==undefined){deltaX=-1*b.wheelDeltaX/120}args.unshift(a,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args)}})(jQuery);



/* Modernizr 2.5.2 (Custom Build) | MIT & BSD
 * Build: http://www.modernizr.com/download/#-csstransforms3d-teststyles-testprop-testallprops-prefixes-domprefixes
 */
;window.Modernizr=function(a,b,c){function y(a){i.cssText=a}function z(a,b){return y(l.join(a+";")+(b||""))}function A(a,b){return typeof a===b}function B(a,b){return!!~(""+a).indexOf(b)}function C(a,b){for(var d in a)if(i[a[d]]!==c)return b=="pfx"?a[d]:!0;return!1}function D(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:A(f,"function")?f.bind(d||b):f}return!1}function E(a,b,c){var d=a.charAt(0).toUpperCase()+a.substr(1),e=(a+" "+n.join(d+" ")+d).split(" ");return A(b,"string")||A(b,"undefined")?C(e,b):(e=(a+" "+o.join(d+" ")+d).split(" "),D(e,b,c))}var d="2.5.2",e={},f=b.documentElement,g="modernizr",h=b.createElement(g),i=h.style,j,k={}.toString,l=" -webkit- -moz- -o- -ms- ".split(" "),m="Webkit Moz O ms",n=m.split(" "),o=m.toLowerCase().split(" "),p={},q={},r={},s=[],t=s.slice,u,v=function(a,c,d,e){var h,i,j,k=b.createElement("div"),l=b.body,m=l?l:b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:g+(d+1),k.appendChild(j);return h=["&#173;","<style>",a,"</style>"].join(""),k.id=g,m.innerHTML+=h,m.appendChild(k),l||f.appendChild(m),i=c(k,a),l?k.parentNode.removeChild(k):m.parentNode.removeChild(m),!!i},w={}.hasOwnProperty,x;!A(w,"undefined")&&!A(w.call,"undefined")?x=function(a,b){return w.call(a,b)}:x=function(a,b){return b in a&&A(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=t.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(t.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(t.call(arguments)))};return e});var F=function(a,c){var d=a.join(""),f=c.length;v(d,function(a,c){var d=b.styleSheets[b.styleSheets.length-1],g=d?d.cssRules&&d.cssRules[0]?d.cssRules[0].cssText:d.cssText||"":"",h=a.childNodes,i={};while(f--)i[h[f].id]=h[f];e.csstransforms3d=(i.csstransforms3d&&i.csstransforms3d.offsetLeft)===9&&i.csstransforms3d.offsetHeight===3},f,c)}([,["@media (",l.join("transform-3d),("),g,")","{#csstransforms3d{left:9px;position:absolute;height:3px;}}"].join("")],[,"csstransforms3d"]);p.csstransforms3d=function(){var a=!!E("perspective");return a&&"webkitPerspective"in f.style&&(a=e.csstransforms3d),a};for(var G in p)x(p,G)&&(u=G.toLowerCase(),e[u]=p[G](),s.push((e[u]?"":"no-")+u));return y(""),h=j=null,e._version=d,e._prefixes=l,e._domPrefixes=o,e._cssomPrefixes=n,e.testProp=function(a){return C([a])},e.testAllProps=E,e.testStyles=v,e}(this,this.document);


/*!
 * jQuery idleTimer plugin
 * version 0.9.100511
 * by Paul Irish.
 *   http://github.com/paulirish/yui-misc/tree/
 * MIT license
 * Copyright (c) 2009 Nicholas C. Zakas
 * adapted from YUI idle timer by nzakas:
 *   http://github.com/nzakas/yui-misc/
*/
(function($){$.idleTimer=function(f,g,h){h=$.extend({startImmediately:true,idle:false,enabled:true,timeout:30000,events:'mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove'},h);g=g||document;var i=function(a){if(typeof a==='number'){a=undefined}var b=$.data(a||g,'idleTimerObj');b.idle=!b.idle;var c=(+new Date())-b.olddate;b.olddate=+new Date();if(b.idle&&(c<h.timeout)){b.idle=false;clearTimeout($.idleTimer.tId);if(h.enabled)$.idleTimer.tId=setTimeout(i,h.timeout);return}var d=jQuery.Event($.data(g,'idleTimer',b.idle?"idle":"active")+'.idleTimer');$(g).trigger(d)},stop=function(a){var b=$.data(a,'idleTimerObj')||{};b.enabled=false;clearTimeout(b.tId);$(a).off('.idleTimer')},handleUserEvent=function(e){var a=$.data(this,'idleTimerObj');clearTimeout(a.tId);if(a.enabled){if(a.idle){i(this)}a.tId=setTimeout(i,a.timeout)}};var j=$.data(g,'idleTimerObj')||{};j.olddate=j.olddate||+new Date();if(typeof f==="number"){h.timeout=f}else if(f==='destroy'){stop(g);return this}else if(f==='getElapsedTime'){return(+new Date())-j.olddate}$(g).on($.trim((h.events+' ').split(' ').join('.idleTimer ')),handleUserEvent);j.idle=h.idle;j.enabled=h.enabled;j.timeout=h.timeout;if(h.startImmediately){j.tId=setTimeout(i,j.timeout)}$.data(g,'idleTimer',"active");$.data(g,'idleTimerObj',j)};$.fn.idleTimer=function(a,b){if(!b){b={}}if(this[0]){$.idleTimer(a,this[0],b)}return this}})(jQuery);